gumbel thresh: 0.505
mode: dy+bi+cl model path: ./ModelFile/crossView_NUCLA/Multi/dy+bi+cl/DIR-tenc-cls-mean-new-clh/ gpu: 3
is_clstoken  True
mean   True
seq_len  5
input projection present encoder:  4025
embed_dim:  8050
embed_proj_dim:  4025
ff_dim:  2048
num_heads:  7
num_layers:  2
dropout:  0.1
seq_len:  5
keys  odict_keys(['backbone.sparseCoding.rr', 'backbone.sparseCoding.theta', 'backbone.transformer_encoder.cls_token', 'backbone.transformer_encoder.input_layer.weight', 'backbone.transformer_encoder.input_layer.bias', 'backbone.transformer_encoder.pos_encoder.pe', 'backbone.transformer_encoder.encoder_layer.self_attn.in_proj_weight', 'backbone.transformer_encoder.encoder_layer.self_attn.in_proj_bias', 'backbone.transformer_encoder.encoder_layer.self_attn.out_proj.weight', 'backbone.transformer_encoder.encoder_layer.self_attn.out_proj.bias', 'backbone.transformer_encoder.encoder_layer.linear1.weight', 'backbone.transformer_encoder.encoder_layer.linear1.bias', 'backbone.transformer_encoder.encoder_layer.linear2.weight', 'backbone.transformer_encoder.encoder_layer.linear2.bias', 'backbone.transformer_encoder.encoder_layer.norm1.weight', 'backbone.transformer_encoder.encoder_layer.norm1.bias', 'backbone.transformer_encoder.encoder_layer.norm2.weight', 'backbone.transformer_encoder.encoder_layer.norm2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm2.bias', 'backbone.Classifier.cls_fc1.weight', 'backbone.Classifier.cls_fc1.bias', 'backbone.Classifier.cls_bn1.weight', 'backbone.Classifier.cls_bn1.bias', 'backbone.Classifier.cls_bn1.running_mean', 'backbone.Classifier.cls_bn1.running_var', 'backbone.Classifier.cls_bn1.num_batches_tracked', 'backbone.Classifier.cls_fc2.weight', 'backbone.Classifier.cls_fc2.bias', 'backbone.Classifier.cls_bn2.weight', 'backbone.Classifier.cls_bn2.bias', 'backbone.Classifier.cls_bn2.running_mean', 'backbone.Classifier.cls_bn2.running_var', 'backbone.Classifier.cls_bn2.num_batches_tracked', 'backbone.Classifier.cls_fc3.weight', 'backbone.Classifier.cls_fc3.bias', 'backbone.Classifier.cls_bn3.weight', 'backbone.Classifier.cls_bn3.bias', 'backbone.Classifier.cls_bn3.running_mean', 'backbone.Classifier.cls_bn3.running_var', 'backbone.Classifier.cls_bn3.num_batches_tracked', 'backbone.Classifier.cls_fc4.weight', 'backbone.Classifier.cls_fc4.bias', 'backbone.Classifier.cls_bn4.weight', 'backbone.Classifier.cls_bn4.bias', 'backbone.Classifier.cls_bn4.running_mean', 'backbone.Classifier.cls_bn4.running_var', 'backbone.Classifier.cls_bn4.num_batches_tracked'])
rr  tensor([1.0738, 0.9827, 0.9756, 1.1247, 0.9363, 1.0295, 1.0171, 0.8772, 1.1414,
        0.8764, 1.0417, 1.0411, 0.9704, 0.8741, 1.0286, 0.8505, 1.1323, 1.0011,
        0.8609, 0.8905, 0.9876, 1.0116, 0.9802, 0.8808, 1.0316, 1.0559, 1.1463,
        1.0903, 0.9350, 1.0455, 0.9752, 0.8884, 0.8512, 1.0178, 1.0932, 1.1434,
        1.1080, 0.9231, 1.1499, 0.9333, 0.9124, 0.8827, 1.0343, 1.0172, 0.8646,
        1.1115, 0.8968, 1.1214, 1.1036, 1.0951, 0.9496, 1.1026, 1.0418, 0.9571,
        1.0756, 1.0673, 0.8579, 1.1263, 1.0073, 1.1280, 1.0781, 0.8988, 0.9347,
        1.0849, 1.0072, 0.9259, 1.0844, 0.8510, 0.8943, 0.8692, 1.0417, 1.1310,
        0.9874, 0.8866, 0.9528, 0.9757, 0.9415, 1.1430, 0.9416, 1.1242],
       device='cuda:3')
theta  tensor([1.3939, 2.4549, 1.6436, 1.5352, 0.7960, 3.0716, 2.6964, 2.0584, 0.7135,
        2.3078, 1.8680, 1.5814, 2.5930, 2.1385, 0.6050, 1.4292, 1.4744, 0.3818,
        2.0396, 2.8664, 0.4994, 2.8990, 1.4337, 2.9520, 2.1435, 1.2748, 0.3789,
        2.3218, 1.4669, 1.7877, 1.0691, 2.8505, 0.6513, 2.9708, 2.0885, 3.0277,
        1.2882, 1.7110, 2.6468, 2.2400, 1.1219, 0.2007, 0.5942, 0.7402, 2.4891,
        0.8861, 1.3891, 2.8232, 2.3094, 0.7382, 2.3175, 1.3819, 0.8533, 0.4777,
        3.0391, 1.8822, 1.2420, 3.1185, 0.1625, 0.9867, 1.3501, 2.3475, 1.5333,
        1.8721, 1.7133, 1.3431, 0.9326, 3.1381, 1.3014, 2.0869, 1.4987, 1.2876,
        2.5508, 0.4858, 1.6475, 0.5840, 1.7340, 1.2651, 3.0234, 2.8446],
       device='cuda:3')
pre_train: /home/balaji/crossView_CL/pretrained/NUCLA/setup1/Multi/pretrainedRHdyan_for_CL.pth
loaded rr  tensor([1.0599, 0.9743, 0.9663, 1.0703, 0.9268, 1.0206, 1.0072, 0.8694, 1.0412,
        0.8684, 1.0341, 1.0315, 0.9607, 0.8662, 0.9808, 0.8436, 1.0713, 0.9619,
        0.8533, 0.8830, 0.9458, 1.0024, 0.9725, 0.8735, 1.0197, 1.0501, 0.9950,
        1.0803, 0.9276, 1.0258, 0.9668, 0.8809, 0.8451, 1.0097, 1.0486, 1.0795,
        1.0817, 0.9156, 1.0775, 0.9241, 0.9034, 0.9111, 0.9747, 1.0095, 0.8571,
        1.0324, 0.8895, 1.0864, 1.0823, 1.0429, 0.9402, 1.0635, 0.9906, 0.9406,
        1.0659, 1.0572, 0.8507, 1.0796, 0.9868, 1.0320, 1.0559, 0.8908, 0.9269,
        1.0619, 0.9963, 0.9183, 1.0403, 0.8440, 0.8867, 0.8616, 1.0331, 1.0858,
        0.9757, 0.8722, 0.9442, 0.9596, 0.9335, 1.0722, 0.9340, 1.0885],
       device='cuda:3')
loaded theta  tensor([1.3831, 2.4351, 1.6302, 1.5173, 0.7894, 3.0460, 2.6738, 2.0410, 0.7377,
        2.2888, 1.8529, 1.5642, 2.5720, 2.1206, 0.6029, 1.4175, 1.4665, 0.3462,
        2.0224, 2.8426, 0.5185, 2.8750, 1.4217, 2.9278, 2.1216, 1.2670, 0.3556,
        2.2961, 1.4546, 1.7748, 1.0654, 2.8268, 0.6468, 2.9488, 2.0768, 3.0085,
        1.2792, 1.6970, 2.6287, 2.2216, 1.1125, 0.2004, 0.5884, 0.7404, 2.4684,
        0.9092, 1.3778, 2.8066, 2.2928, 0.7396, 2.2984, 1.3781, 0.8437, 0.4658,
        3.0172, 1.8672, 1.2320, 3.0912, 0.1108, 0.9424, 1.3398, 2.3283, 1.5204,
        1.8600, 1.6995, 1.3323, 0.9231, 3.1122, 1.2911, 2.0694, 1.4857, 1.2852,
        2.5297, 0.4884, 1.6341, 0.5822, 1.7197, 1.2677, 2.9984, 2.8182],
       device='cuda:3')
new_dict  odict_keys(['backbone.sparseCoding.rr', 'backbone.sparseCoding.theta', 'backbone.transformer_encoder.cls_token', 'backbone.transformer_encoder.input_layer.weight', 'backbone.transformer_encoder.input_layer.bias', 'backbone.transformer_encoder.pos_encoder.pe', 'backbone.transformer_encoder.encoder_layer.self_attn.in_proj_weight', 'backbone.transformer_encoder.encoder_layer.self_attn.in_proj_bias', 'backbone.transformer_encoder.encoder_layer.self_attn.out_proj.weight', 'backbone.transformer_encoder.encoder_layer.self_attn.out_proj.bias', 'backbone.transformer_encoder.encoder_layer.linear1.weight', 'backbone.transformer_encoder.encoder_layer.linear1.bias', 'backbone.transformer_encoder.encoder_layer.linear2.weight', 'backbone.transformer_encoder.encoder_layer.linear2.bias', 'backbone.transformer_encoder.encoder_layer.norm1.weight', 'backbone.transformer_encoder.encoder_layer.norm1.bias', 'backbone.transformer_encoder.encoder_layer.norm2.weight', 'backbone.transformer_encoder.encoder_layer.norm2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.linear2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.0.norm2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.linear2.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm1.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm1.bias', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm2.weight', 'backbone.transformer_encoder.transformer_encoder.layers.1.norm2.bias', 'backbone.Classifier.cls_fc1.weight', 'backbone.Classifier.cls_fc1.bias', 'backbone.Classifier.cls_bn1.weight', 'backbone.Classifier.cls_bn1.bias', 'backbone.Classifier.cls_bn1.running_mean', 'backbone.Classifier.cls_bn1.running_var', 'backbone.Classifier.cls_bn1.num_batches_tracked', 'backbone.Classifier.cls_fc2.weight', 'backbone.Classifier.cls_fc2.bias', 'backbone.Classifier.cls_bn2.weight', 'backbone.Classifier.cls_bn2.bias', 'backbone.Classifier.cls_bn2.running_mean', 'backbone.Classifier.cls_bn2.running_var', 'backbone.Classifier.cls_bn2.num_batches_tracked', 'backbone.Classifier.cls_fc3.weight', 'backbone.Classifier.cls_fc3.bias', 'backbone.Classifier.cls_bn3.weight', 'backbone.Classifier.cls_bn3.bias', 'backbone.Classifier.cls_bn3.running_mean', 'backbone.Classifier.cls_bn3.running_var', 'backbone.Classifier.cls_bn3.num_batches_tracked', 'backbone.Classifier.cls_fc4.weight', 'backbone.Classifier.cls_fc4.bias', 'backbone.Classifier.cls_bn4.weight', 'backbone.Classifier.cls_bn4.bias', 'backbone.Classifier.cls_bn4.running_mean', 'backbone.Classifier.cls_bn4.running_var', 'backbone.Classifier.cls_bn4.num_batches_tracked'])
stateDict keys  odict_keys(['backbone.sparseCoding.rr', 'backbone.sparseCoding.theta', 'backbone.Classifier.conv1.weight', 'backbone.Classifier.conv1.bias', 'backbone.Classifier.bn1.weight', 'backbone.Classifier.bn1.bias', 'backbone.Classifier.bn1.running_mean', 'backbone.Classifier.bn1.running_var', 'backbone.Classifier.bn1.num_batches_tracked', 'backbone.Classifier.conv2.weight', 'backbone.Classifier.conv2.bias', 'backbone.Classifier.bn2.weight', 'backbone.Classifier.bn2.bias', 'backbone.Classifier.bn2.running_mean', 'backbone.Classifier.bn2.running_var', 'backbone.Classifier.bn2.num_batches_tracked', 'backbone.Classifier.conv3.weight', 'backbone.Classifier.conv3.bias', 'backbone.Classifier.bn3.weight', 'backbone.Classifier.bn3.bias', 'backbone.Classifier.bn3.running_mean', 'backbone.Classifier.bn3.running_var', 'backbone.Classifier.bn3.num_batches_tracked', 'backbone.Classifier.conv4.weight', 'backbone.Classifier.conv4.bias', 'backbone.Classifier.bn4.weight', 'backbone.Classifier.bn4.bias', 'backbone.Classifier.bn4.running_mean', 'backbone.Classifier.bn4.running_var', 'backbone.Classifier.bn4.num_batches_tracked', 'backbone.Classifier.conv5.weight', 'backbone.Classifier.conv5.bias', 'backbone.Classifier.bn5.weight', 'backbone.Classifier.bn5.bias', 'backbone.Classifier.bn5.running_mean', 'backbone.Classifier.bn5.running_var', 'backbone.Classifier.bn5.num_batches_tracked', 'backbone.Classifier.conv6.weight', 'backbone.Classifier.conv6.bias', 'backbone.Classifier.bn6.weight', 'backbone.Classifier.bn6.bias', 'backbone.Classifier.bn6.running_mean', 'backbone.Classifier.bn6.running_var', 'backbone.Classifier.bn6.num_batches_tracked', 'backbone.Classifier.fc.weight', 'backbone.Classifier.fc.bias', 'backbone.Classifier.fc2.weight', 'backbone.Classifier.fc2.bias', 'backbone.Classifier.fc3.weight', 'backbone.Classifier.fc3.bias', 'backbone.Classifier.cls.0.weight', 'backbone.Classifier.cls.0.bias', 'proj.weight', 'proj.bias'])
plist  57
noplist  57
p  backbone.sparseCoding.rr False
p  backbone.sparseCoding.theta False
p  backbone.transformer_encoder.cls_token True
p  backbone.transformer_encoder.input_layer.weight True
p  backbone.transformer_encoder.input_layer.bias True
p  backbone.transformer_encoder.encoder_layer.self_attn.in_proj_weight True
p  backbone.transformer_encoder.encoder_layer.self_attn.in_proj_bias True
p  backbone.transformer_encoder.encoder_layer.self_attn.out_proj.weight True
p  backbone.transformer_encoder.encoder_layer.self_attn.out_proj.bias True
p  backbone.transformer_encoder.encoder_layer.linear1.weight True
p  backbone.transformer_encoder.encoder_layer.linear1.bias True
p  backbone.transformer_encoder.encoder_layer.linear2.weight True
p  backbone.transformer_encoder.encoder_layer.linear2.bias True
p  backbone.transformer_encoder.encoder_layer.norm1.weight True
p  backbone.transformer_encoder.encoder_layer.norm1.bias True
p  backbone.transformer_encoder.encoder_layer.norm2.weight True
p  backbone.transformer_encoder.encoder_layer.norm2.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.in_proj_bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.self_attn.out_proj.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.linear1.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.linear1.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.linear2.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.linear2.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.norm1.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.norm1.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.0.norm2.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.0.norm2.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.in_proj_bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.self_attn.out_proj.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.linear1.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.linear1.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.linear2.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.linear2.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.norm1.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.norm1.bias True
p  backbone.transformer_encoder.transformer_encoder.layers.1.norm2.weight True
p  backbone.transformer_encoder.transformer_encoder.layers.1.norm2.bias True
p  backbone.Classifier.cls_fc1.weight True
p  backbone.Classifier.cls_fc1.bias True
p  backbone.Classifier.cls_bn1.weight True
p  backbone.Classifier.cls_bn1.bias True
p  backbone.Classifier.cls_fc2.weight True
p  backbone.Classifier.cls_fc2.bias True
p  backbone.Classifier.cls_bn2.weight True
p  backbone.Classifier.cls_bn2.bias True
p  backbone.Classifier.cls_fc3.weight True
p  backbone.Classifier.cls_fc3.bias True
p  backbone.Classifier.cls_bn3.weight True
p  backbone.Classifier.cls_bn3.bias True
p  backbone.Classifier.cls_fc4.weight True
p  backbone.Classifier.cls_fc4.bias True
p  backbone.Classifier.cls_bn4.weight True
p  backbone.Classifier.cls_bn4.bias True
after rr  tensor([1.0599, 0.9743, 0.9663, 1.0703, 0.9268, 1.0206, 1.0072, 0.8694, 1.0412,
        0.8684, 1.0341, 1.0315, 0.9607, 0.8662, 0.9808, 0.8436, 1.0713, 0.9619,
        0.8533, 0.8830, 0.9458, 1.0024, 0.9725, 0.8735, 1.0197, 1.0501, 0.9950,
        1.0803, 0.9276, 1.0258, 0.9668, 0.8809, 0.8451, 1.0097, 1.0486, 1.0795,
        1.0817, 0.9156, 1.0775, 0.9241, 0.9034, 0.9111, 0.9747, 1.0095, 0.8571,
        1.0324, 0.8895, 1.0864, 1.0823, 1.0429, 0.9402, 1.0635, 0.9906, 0.9406,
        1.0659, 1.0572, 0.8507, 1.0796, 0.9868, 1.0320, 1.0559, 0.8908, 0.9269,
        1.0619, 0.9963, 0.9183, 1.0403, 0.8440, 0.8867, 0.8616, 1.0331, 1.0858,
        0.9757, 0.8722, 0.9442, 0.9596, 0.9335, 1.0722, 0.9340, 1.0885],
       device='cuda:3')
after theta  tensor([1.3831, 2.4351, 1.6302, 1.5173, 0.7894, 3.0460, 2.6738, 2.0410, 0.7377,
        2.2888, 1.8529, 1.5642, 2.5720, 2.1206, 0.6029, 1.4175, 1.4665, 0.3462,
        2.0224, 2.8426, 0.5185, 2.8750, 1.4217, 2.9278, 2.1216, 1.2670, 0.3556,
        2.2961, 1.4546, 1.7748, 1.0654, 2.8268, 0.6468, 2.9488, 2.0768, 3.0085,
        1.2792, 1.6970, 2.6287, 2.2216, 1.1125, 0.2004, 0.5884, 0.7404, 2.4684,
        0.9092, 1.3778, 2.8066, 2.2928, 0.7396, 2.2984, 1.3781, 0.8437, 0.4658,
        3.0172, 1.8672, 1.2320, 3.0912, 0.1108, 0.9424, 1.3398, 2.3283, 1.5204,
        1.8600, 1.6995, 1.3323, 0.9231, 3.1122, 1.2911, 2.0694, 1.4857, 1.2852,
        2.5297, 0.4884, 1.6341, 0.5822, 1.7197, 1.2677, 2.9984, 2.8182],
       device='cuda:3')
optimizer  SGD (
Parameter Group 0
    dampening: 0
    lr: 0.0001
    momentum: 0.9
    nesterov: False
    weight_decay: 0.001

Parameter Group 1
    dampening: 0
    lr: 0.0005
    momentum: 0.9
    nesterov: False
    weight_decay: 0.001

Parameter Group 2
    dampening: 0
    lr: 0.001
    momentum: 0.9
    nesterov: False
    weight_decay: 0.001
)
lr_step  [50, 100, 140]
lr_drop  0.3
num epochs  160
start training epoch: 0
